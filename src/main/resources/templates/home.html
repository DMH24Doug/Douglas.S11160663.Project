<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/chatbot.css}">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500&display=swap" rel="stylesheet">

</head>
<body>
<nav>

    <img th:src="@{/image/logo.png}" alt="Logo" class="logo">

    <h1>CWM HEALTH WEBPAGE</h1>
    <ul>
        <li><a href="#">About</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="#">Contact</a></li>
        <li ><a th:href="@{/login}" class="signin">Sign In</a></li>
    </ul>


</nav>

            <!-- Floating Chatbot Button -->
            <button class="chatbot-button" onclick="toggleChatWindow()">ðŸ’¬</button>

            <!-- Chat Window -->
            <div class="chat-window" id="chatWindow">
                <div class="chat-header">
                    Chatbot
                </div>
                <div class="chat-body" id="chatBody">
                    <!-- Messages will be appended here -->
                </div>
                <div class="chat-footer">
                    <input type="text" id="chatInput" class="chat-input" placeholder="Type a message...">
                    <button class="send-button" onclick="sendMessage()">Send</button>
                </div>
            </div>

        <script>
            // Toggle Chat Window Visibility
            function toggleChatWindow() {
                const chatWindow = document.getElementById('chatWindow');
                chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
            }

            // Send Message to Chatbot
            async function sendMessage() {
                const chatInput = document.getElementById('chatInput');
                const message = chatInput.value.trim();
                if (message === '') return;

                appendMessage('user', message);

                const response = await fetch('/chatbot/message', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message }),
                });
                const data = await response.json();
                appendMessage('bot', data.reply);

                chatInput.value = '';
            }

            // Append Message to Chat Window
            function appendMessage(sender, text) {
                const chatBody = document.getElementById('chatBody');
                const messageElement = document.createElement('div');
                messageElement.className = `message ${sender}`;
                messageElement.textContent = text;
                chatBody.appendChild(messageElement);
                chatBody.scrollTop = chatBody.scrollHeight;
            }
        </script>
</body>
</html>