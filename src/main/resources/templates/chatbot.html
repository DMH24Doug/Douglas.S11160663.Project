<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" type="text/css" th:href="@{/css/chatbot.css}">
    <meta charset="UTF-8">
    <title>chatbot</title>
</head>
<body>
    <h1>CHAT BOT TRAIL</h1>

        <!-- Floating Chatbot Button -->
        <button class="chatbot-button" onclick="toggleChatWindow()">ðŸ’¬</button>

        <!-- Chat Window -->
        <div class="chat-window" id="chatWindow">
          <div class="chat-header">
            Chatbot
          </div>
          <div class="chat-body" id="chatBody">
            <!-- Messages will be appended here -->
          </div>
          <div class="chat-footer">
            <input type="text" id="chatInput" class="chat-input" placeholder="Type a message...">
            <button class="send-button" onclick="sendMessage()">Send</button>
          </div>
        </div>

    <script>
      // Toggle Chat Window Visibility
      function toggleChatWindow() {
        const chatWindow = document.getElementById('chatWindow');
        chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
      }

      // Send Message to Chatbot
      async function sendMessage() {
        const chatInput = document.getElementById('chatInput');
        const message = chatInput.value.trim();
        if (message === '') return;

        appendMessage('user', message);

        const response = await fetch('/chatbot/message', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ message }),
        });
        const data = await response.json();
        appendMessage('bot', data.reply);

        chatInput.value = '';
      }

      // Append Message to Chat Window
      function appendMessage(sender, text) {
        const chatBody = document.getElementById('chatBody');
        const messageElement = document.createElement('div');
        messageElement.className = `message ${sender}`;
        messageElement.textContent = text;
        chatBody.appendChild(messageElement);
        chatBody.scrollTop = chatBody.scrollHeight;
      }
    </script>
</body>
</html>